# This rule should put all files into one huge bcf file
rule bcftools_mpileup_all:
    input:
        alignments=mapped_reads_parents + "{parent_sample}dupped.bam",
        ref=genome,
        index=genome + ".fai",
    output:
        pileup= vcfs + "{parent_sample}.bcf",
    params:
        uncompressed_bcf=False,
        extra="--max-depth 100 --min-BQ 10",
    log:
        "logs/bcftools_mpileup/{parent_sample}.log",
    wrapper:
        "v2.6.0/bio/bcftools/mpileup"

